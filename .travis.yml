language: java
install: mvn install
before_install:
 - openssl aes-256-cbc -K $encrypted_b9997e150274_key -iv $encrypted_b9997e150274_iv -in key.asc.enc -out key.asc -d
 - echo $GPG_PASSPHRASE | gpg --passphrase-fd 0 --batch --yes --import key.asc

after_success:
 - bash <(curl -s https://codecov.io/bash)

deploy:
- provider: script
  script: mvn deploy --settings .travis/settings.xml -DskipTests=true -B -U -Prelease
  skip_cleanup: true
  on:
    repo: imrafaelmerino/vertx-mongo-values
    tags: true
- provider: releases
  skip_cleanup: true
  api_key: "$GITHUB_TOKEN"
  draft: false
  prerelease: false
  body: 'Generated by TravisCI during the release process: build URL: $TRAVIS_BUILD_WEB_URL,
    build number: $TRAVIS_BUILD_NUMBER, commit: $TRAVIS_COMMIT, tag: $TRAVIS_TAG'
  name: Astro
  file:
  - target/JAVADOC.zip
  - docs/CHANGELOG.md
  - docs/README.md
  - target/SOURCES.zip
  on:
    repo: imrafaelmerino/vertx-mongo-values
    tags: true
addons:
  sonarcloud:
    organization: imrafaelmerino
    token:
      secure: OoTgmAznSwYzBxddQF37DjMgb3hXWViEopkj7WDFhYTRRXgcXVQU0poFvO5EfeN4SkB1wmZPDpbuYuzfy/DAv/NSvTA8OCkzAUbZFlkW3VqVL8+9vLIbbB4jj1UJ9PUuWxTfAep3r/yHH9lJN67CYCimXq2crlBN0/OaBS4Q3gqY6DG1W88aTFkASB4NmirA+gVQ+IPKmWfIogC2/9tuc08X+KgZLbBFsWHIQeVXhQEY6dIac3UnJq8wrXYPEiM27r4QRmREWfoHB9Ex2ljUm7nzzbAFpo3inL/Y9NdAHyz6ibz4y2s5InRWlA5cwLLfKQ/pHW7ZdJTTjQUwVliBJp5zuHKe6KbiOtmJ7bhhW680ioXPZqST3ZVvQOgNZQMQXJcTq5+qEuVj+yczfUyDYjv7L0R37B0/Co2gFbjT9aHaConBFlsrRQaRjckPVovSec1107iD0r8FcusORp9q2Cj5O07IiHYHXDVs7UckgNi+Mz4cr33UzneOulY1UhUtt9kY5bAAqE2uNxhQ6onrFq3CkgbzGnoH+1zIunkx+aCOKDxoXZErf9tHM7qA8nx1yh/H8zlw1PqXGC2kH28s9375ylhjc5qQ/jWN3gAzDswIWt90ID2iMi+s5dYMJD0hfWbvtefoST5LvsNfcrt5lDaRi+7WaUfZxMLoQlTD9Kw=
script:
- mvn clean verify sonar:sonar -Pcoverage -Dsonar.projectKey=imrafaelmerino_vertx-mongo-values
